; macOS sandbox profile for Codex (deny secret reads).
(version 1)

; Allow normal operation by default, then explicitly deny secrets.
(allow default)

; .env and variants
(deny file-read* (regex #".*/\.env(\..*)?$"))

; Common credential files
(deny file-read* (regex #".*/\.git-credentials$"))
(deny file-read* (regex #".*/\.npmrc$"))
(deny file-read* (regex #".*/\.pypirc$"))

; SSH and cloud credentials
(deny file-read* (home-subpath ".ssh"))
(deny file-read* (home-subpath ".aws/credentials"))
(deny file-read* (home-subpath ".config/gcloud"))

; Private keys and certificates
(deny file-read* (regex #".*/id_rsa$"))
(deny file-read* (regex #".*\.(pem|key|p12|pfx)$"))
